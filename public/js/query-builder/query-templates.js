/**
 * Query Templates can be defined as object with the fields:
 * > select
 * > body
 * > aggregate
 * 
 * The select is a SPARQL select statement. The body is an array of strings with each string being a line of a 
 * SPARQL query. The string %QUERY% can be used to insert the query generated by the QueryBuilder. The aggregate
 * is a SPARQL aggregate statement.
 */
 class QueryTemplates {

  static DEFAULT_PREFIXES = [
    `PREFIX databus: <https://dataid.dbpedia.org/databus#>`,
    `PREFIX databus: <https://dataid.dbpedia.org/databus#>`,
    `PREFIX dcv: <https://dataid.dbpedia.org/databus-cv#>`,
    `PREFIX dct:    <http://purl.org/dc/terms/>`,
    `PREFIX dcat:   <http://www.w3.org/ns/dcat#>`,
    `PREFIX rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#>`,
    `PREFIX rdfs:   <http://www.w3.org/2000/01/rdf-schema#>`
  ];


  static COLLECTION_STATISTICS_TEMPLATE = {
    indent: 1,
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    select: `SELECT DISTINCT ?dataset ?file ?license ?size WHERE`,
    body: [
      `GRAPH ?g`,
      `{`,
      `%QUERY%`,
      `\t?dataset dcat:distribution ?distribution .`,
      `\t?distribution databus:file ?file .`,
      `\tOPTIONAL { ?dataset dct:license ?license . }`,
      `\tOPTIONAL { ?distribution dcat:byteSize ?size . }`,
      `}`
    ]
  };

  static COLLECTION_FILES_TEMPLATE = {
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    indent: 1,
    select: `SELECT DISTINCT ?version ?dataset ?distribution ?title ?description (GROUP_CONCAT(DISTINCT ?file; SEPARATOR=", ") AS ?files) ?license ?size ?format (GROUP_CONCAT(DISTINCT ?var; SEPARATOR=', ') AS ?variant) ?preview WHERE`,
    body: [
      `GRAPH ?g`,
      `{`,
      `%QUERY%`,
      `\t?distribution databus:file ?file .`,
      `\t?distribution databus:formatExtension ?format .`,
      `\tOPTIONAL { ?distribution ?p  ?var. ?p rdfs:subPropertyOf databus:contentVariant . }`,
      `\tOPTIONAL { ?dataset dct:license ?license . }`,
      `\tOPTIONAL { ?distribution dcat:byteSize ?size . }`,
      `\t?dataset dcat:distribution ?distribution .`,
      `\t?dataset dct:hasVersion ?version .`,
      `\t?dataset dct:title ?title .`,
      `\t?dataset dct:description ?description.`,
      `}`
    ],
    aggregate: `GROUP BY ?version ?dataset ?distribution ?title ?description ?license ?size ?format ?preview`
  };

  /**
   * Selects files with additional information for group pages
   */
   static GROUP_PAGE_FILE_BROWSER_TEMPLATE = {
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    indent: 1,
    select: `SELECT DISTINCT ?file ?version ?artifact ?license ?size ?format ?compression (GROUP_CONCAT(DISTINCT ?var; SEPARATOR=', ') AS ?variant) ?preview WHERE`,
    body: [

      `GRAPH ?g`,
      `{`,
      `%QUERY%`,
      `\t?dataset dcat:distribution ?distribution .`,
      `\t?distribution databus:file ?file .`,
      `\t?distribution databus:formatExtension ?format .`,
      `\t?distribution databus:compression ?compression .`,
      `\t?dataset dct:license ?license .`,
      `\t?dataset dct:hasVersion ?version .`,
      `\t?dataset databus:artifact ?artifact .`,
      `\tOPTIONAL { ?distribution ?p ?var. ?p rdfs:subPropertyOf databus:contentVariant . }`,
      `\tOPTIONAL { ?distribution dcat:byteSize ?size . }`,
      `}`
    ],
    aggregate: `GROUP BY ?file ?version ?artifact ?license ?size ?format ?compression ?preview`
  };

  /**
   * Selects files with additional information
   */
  static NODE_FILE_TEMPLATE = {
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    indent: 1,
    select: `SELECT DISTINCT ?file ?license ?size ?format ?compression (GROUP_CONCAT(DISTINCT ?var; SEPARATOR=', ') AS ?variant) ?preview WHERE`,
    body: [

      `GRAPH ?g`,
      `{`,
      `%QUERY%`,
      `\t?dataset dcat:distribution ?distribution .`,
      `\t?distribution databus:file ?file .`,
      `\t?distribution databus:formatExtension ?format .`,
      `\t?distribution databus:compression ?compression .`,
      `\t?dataset dct:license ?license .`,
      `\tOPTIONAL { ?distribution ?p ?var. ?p rdfs:subPropertyOf databus:contentVariant . }`,
      `\tOPTIONAL { ?distribution dcat:byteSize ?size . }`,
      `}`
    ],
    aggregate: `GROUP BY ?file ?license ?size ?format ?compression ?preview`
  };

  /**
   * The default selection (only file)
   */
  static DEFAULT_FILE_TEMPLATE = {
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    indent: 1,
    select: `SELECT ?file WHERE`,
    body: [
      `GRAPH ?g`,
      `{`,
      `%QUERY%`,
      `\t?dataset dcat:distribution ?distribution .`,
      `\t?distribution databus:file ?file .`,
      `}`,
    ]
  };

  /**
   * The default selection (only file)
   */
   static CUSTOM_QUERY_FILE_TEMPLATE = {
    prefixes: QueryTemplates.DEFAULT_PREFIXES,
    indent: 1,
    select: `SELECT ?file WHERE`,
    body: [
      `{`,
      `%QUERY%`,
      `}`,
    ]
  };
}

module.exports = QueryTemplates;